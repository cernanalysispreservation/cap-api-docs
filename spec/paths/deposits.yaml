post:
  summary: Create a new draft
  description: >
    To create a new draft you need to pass a valid analysis type OR JSON Schema.
    (`$ana_type`/`$schema`)


    > Analysis types (`$ana_type`) and JSON Schemas (`$schema`) depend on the access rights
    of the logged in user and mainly correspond to the CERN collaboration you are part of
    (***ALICE, ATLAS, CMS, LHCb***).

  tags:
    - Deposits
  requestBody:
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/Deposit'
        examples:
          simple_with_ana_type:
            value:
              $ana_type: cms-analysis
          simple_with_schema:
            value:
              $schema: >-
                https://analysispreservation.cern.ch/api/schemas/deposits/records/cms-analysis-v0.0.1.json
          advanced:
            value:
              $schema: >-
                https://analysispreservation.cern.ch/api/schemas/deposits/records/cms-analysis-v0.0.1.json
              analysis_title: This is a title that describes my analysis
  responses:
    '201':
      description: Created
      headers:
        X-Rate-Limit:
          $ref: '#/components/headers/RateLimit'
        X-Expires-After:
          $ref: '#/components/headers/ExpiresAfter'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/DepositResponse'
          examples:
            depositResponse:
              $ref: '#/components/examples/depositResponse'
    '400':
      description: Validation error
      content:
        application/json:
          examples:
            noAnatypeNoSchema:
              $ref: '#/components/examples/noAnatypeNoSchema'
            validationError:
              $ref: '#/components/examples/validationError'
    '401':
      $ref: '#/components/responses/NotAuthorized'
get:
  summary: List all drafts
  description: >-
    List all deposits for the currently authenticated user.

    > You need to have at least `read` access to query the resource.
  tags:
    - Deposits
  parameters:
    - $ref: '#/components/parameters/query'
    - $ref: '#/components/parameters/status'
    - $ref: '#/components/parameters/sort'
    - $ref: '#/components/parameters/page'
    - $ref: '#/components/parameters/size'
  responses:
    '200':
      description: OK
      headers:
        X-Rate-Limit:
          $ref: '#/components/headers/RateLimit'
        X-Expires-After:
          $ref: '#/components/headers/ExpiresAfter'
      content:
        application/json:
          schema:
            type: object
            properties:
              aggregations:
                type: object
                description: Aggregations of returned results
              hits:
                type: object
                properties:
                  hits:
                    $ref: '#/components/schemas/Record'
                  total:
                    type: number
                    description: Total number of results
              links:
                type: object
                description: Links related with the deposits results (ex. prev/next page)
          example:
            aggregations: {}
            hits:
              hits:
                - can_admin: true
                  can_edit: true
                  created: '2018-11-05T09:16:31.496137+00:00'
                  id: CAP.ALICE.FPEE.8XTW
                  links:
                    self: >-
                      https://analysispreservation.cern.ch/records/CAP.ALICE.FPEE.8XTW
                  metadata: {}
                  published:
                    revision_id: 0
                    type: recid
                    value: CAP.ALICE.FPEE.8XTW
                  revision: 0
                  schema: >-
                    https://analysispreservation.cern.ch/schemas/records/alice-analysis-v0.0.1.json
                  status: published
                  updated: '2018-11-05T09:16:31.496146+00:00'
                - {}
                - {}
              total: 130
            links:
              next: >-
                https://analysispreservation.cern.ch/api/deposits/?sort=mostrecent&page=3&size=10
              prev: >-
                https://analysispreservation.cern.ch/api/deposits/?sort=mostrecent&page=1&size=10
              self: >-
                https://analysispreservation.cern.ch/api/deposits/?sort=mostrecent&page=2&size=10
    '401':
      $ref: '#/components/responses/NotAuthorized'
